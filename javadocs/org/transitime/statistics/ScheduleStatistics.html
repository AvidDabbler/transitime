<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_25) on Mon Aug 25 17:40:07 PDT 2014 -->
<title>ScheduleStatistics</title>
<meta name="date" content="2014-08-25">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="ScheduleStatistics";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ScheduleStatistics.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../org/transitime/statistics/ScheduleDataProcessor.TripStopKey.html" title="class in org.transitime.statistics"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../org/transitime/statistics/ScheduleStatistics.Stats.html" title="class in org.transitime.statistics"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/transitime/statistics/ScheduleStatistics.html" target="_top">Frames</a></li>
<li><a href="ScheduleStatistics.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.transitime.statistics</div>
<h2 title="Class ScheduleStatistics" class="title">Class ScheduleStatistics</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.transitime.statistics.ScheduleStatistics</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">ScheduleStatistics</span>
extends java.lang.Object</pre>
<div class="block">Contains methods for taking arrival/departure info that is collected
 in maps and processing it to determine optimal schedule.
 <p>
 Once all of the arrival and departure times have been processed into a map
 statistics is used to determine which is the best arrival/departure for the
 stop_times output. The goal is to use a time such that only the a desired
 fraction of arrivals/departures will be early. For example, if you want only
 20% of the vehicle to be early with respect to the schedule time, which is
 reasonable because for passengers it is better for vehicles to be late rather
 then early so they don't miss the vehicle, then the value should be 0.2. This
 desiredFractionEarly value is specified when the ScheduleDataProcessor object is
 constructed.
 <p>
 The way the software tries to achieve the desiredFractionEarly is by assuming
 there is a Gaussian distribution of the times. By using the standard
 deviation of a Gaussian distribution the software estimates the value to use
 to such that desiredFractionEarly will be attained. Of course the
 distribution is not truly Gaussian. Therefore several iterations are used to
 adjust the value in order to get the desired results.
 <p>
 Note: convenient website for determining standard deviation is at
 http://www.mathsisfun.com/data/standard-deviation-calculator.html</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>SkiBu Smith</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../org/transitime/statistics/ScheduleStatistics.Stats.html" title="class in org.transitime.statistics">ScheduleStatistics.Stats</a></strong></code>
<div class="block">For containing the results of processing AVL based arrival/departure
 times as part of determining more accurate schedule times.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../org/transitime/statistics/ScheduleStatistics.html#ScheduleStatistics()">ScheduleStatistics</a></strong>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../../org/transitime/statistics/ScheduleStatistics.html#determineStatsForRoute(java.util.Map, java.util.Map, java.util.Map, java.lang.String, int, int, double, org.transitime.db.structs.ArrivalDeparture.ArrivalsOrDepartures)">determineStatsForRoute</a></strong>(java.util.Map&lt;<a href="../../../org/transitime/statistics/ScheduleDataProcessor.TripStopKey.html" title="class in org.transitime.statistics">ScheduleDataProcessor.TripStopKey</a>,<a href="../../../org/transitime/gtfs/gtfsStructs/GtfsStopTime.html" title="class in org.transitime.gtfs.gtfsStructs">GtfsStopTime</a>&gt;&nbsp;originalGtfsStopTimes,
                      java.util.Map&lt;<a href="../../../org/transitime/statistics/ScheduleDataProcessor.TripStopKey.html" title="class in org.transitime.statistics">ScheduleDataProcessor.TripStopKey</a>,java.util.List&lt;java.lang.Integer&gt;&gt;&nbsp;timesFromDbByTripStopForRouteSubMap,
                      java.util.Map&lt;<a href="../../../org/transitime/statistics/ScheduleDataProcessor.TripStopKey.html" title="class in org.transitime.statistics">ScheduleDataProcessor.TripStopKey</a>,<a href="../../../org/transitime/statistics/ScheduleStatistics.Stats.html" title="class in org.transitime.statistics">ScheduleStatistics.Stats</a>&gt;&nbsp;statsResultsByTripStopMap,
                      java.lang.String&nbsp;routeId,
                      int&nbsp;allowableDifferenceFromMeanSecs,
                      int&nbsp;allowableDifferenceFromOriginalTimeSecs,
                      double&nbsp;desiredFractionEarly,
                      <a href="../../../org/transitime/db/structs/ArrivalDeparture.ArrivalsOrDepartures.html" title="enum in org.transitime.db.structs">ArrivalDeparture.ArrivalsOrDepartures</a>&nbsp;arrivalsOrDepartures)</code>
<div class="block">For the route specified first determines the basic stats including the
 mean and standard deviation.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../../org/transitime/statistics/ScheduleStatistics.html#processScheduleAdherence(java.util.Map, java.util.Map, java.util.Map, int, int)">processScheduleAdherence</a></strong>(java.util.Map&lt;<a href="../../../org/transitime/statistics/ScheduleDataProcessor.TripStopKey.html" title="class in org.transitime.statistics">ScheduleDataProcessor.TripStopKey</a>,<a href="../../../org/transitime/gtfs/gtfsStructs/GtfsStopTime.html" title="class in org.transitime.gtfs.gtfsStructs">GtfsStopTime</a>&gt;&nbsp;gtfsStopTimes,
                        java.util.Map&lt;<a href="../../../org/transitime/statistics/ScheduleDataProcessor.TripStopKey.html" title="class in org.transitime.statistics">ScheduleDataProcessor.TripStopKey</a>,<a href="../../../org/transitime/statistics/ScheduleStatistics.Stats.html" title="class in org.transitime.statistics">ScheduleStatistics.Stats</a>&gt;&nbsp;arrivalStatsResultsByTripStopMap,
                        java.util.Map&lt;<a href="../../../org/transitime/statistics/ScheduleDataProcessor.TripStopKey.html" title="class in org.transitime.statistics">ScheduleDataProcessor.TripStopKey</a>,<a href="../../../org/transitime/statistics/ScheduleStatistics.Stats.html" title="class in org.transitime.statistics">ScheduleStatistics.Stats</a>&gt;&nbsp;departureStatsResultsByTripStopMap,
                        int&nbsp;allowableEarlySecs,
                        int&nbsp;allowableLateSecs)</code>
<div class="block">Determines and logs schedule adherence results both using the original
 schedule and using the new improved schedule.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ScheduleStatistics()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ScheduleStatistics</h4>
<pre>public&nbsp;ScheduleStatistics()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="determineStatsForRoute(java.util.Map, java.util.Map, java.util.Map, java.lang.String, int, int, double, org.transitime.db.structs.ArrivalDeparture.ArrivalsOrDepartures)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>determineStatsForRoute</h4>
<pre>public static&nbsp;void&nbsp;determineStatsForRoute(java.util.Map&lt;<a href="../../../org/transitime/statistics/ScheduleDataProcessor.TripStopKey.html" title="class in org.transitime.statistics">ScheduleDataProcessor.TripStopKey</a>,<a href="../../../org/transitime/gtfs/gtfsStructs/GtfsStopTime.html" title="class in org.transitime.gtfs.gtfsStructs">GtfsStopTime</a>&gt;&nbsp;originalGtfsStopTimes,
                          java.util.Map&lt;<a href="../../../org/transitime/statistics/ScheduleDataProcessor.TripStopKey.html" title="class in org.transitime.statistics">ScheduleDataProcessor.TripStopKey</a>,java.util.List&lt;java.lang.Integer&gt;&gt;&nbsp;timesFromDbByTripStopForRouteSubMap,
                          java.util.Map&lt;<a href="../../../org/transitime/statistics/ScheduleDataProcessor.TripStopKey.html" title="class in org.transitime.statistics">ScheduleDataProcessor.TripStopKey</a>,<a href="../../../org/transitime/statistics/ScheduleStatistics.Stats.html" title="class in org.transitime.statistics">ScheduleStatistics.Stats</a>&gt;&nbsp;statsResultsByTripStopMap,
                          java.lang.String&nbsp;routeId,
                          int&nbsp;allowableDifferenceFromMeanSecs,
                          int&nbsp;allowableDifferenceFromOriginalTimeSecs,
                          double&nbsp;desiredFractionEarly,
                          <a href="../../../org/transitime/db/structs/ArrivalDeparture.ArrivalsOrDepartures.html" title="enum in org.transitime.db.structs">ArrivalDeparture.ArrivalsOrDepartures</a>&nbsp;arrivalsOrDepartures)</pre>
<div class="block">For the route specified first determines the basic stats including the
 mean and standard deviation. Then determines how many standard deviations
 to use for this route such that get approximately the desired fraction of
 times being earlier than the mean minus the number of standard deviations
 for this trip/stop. Puts the resulting Stats objects that now contain the
 best arrival/departure value to use into statsResultsByTripStopMap. This
 is done on a per route basis since it is expected that the distribution
 of the stats will vary between routes.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>originalGtfsStopTimes</code> - original data from stop_times.txt file so that can filter out
            outliers. Can be null for testing. Map is keyed on trip/stops
            and contains GtfsStopTimes.</dd><dd><code>timesFromDbByTripStopForRouteSubMap</code> - the arrival/departure times for the route</dd><dd><code>statsResultsByTripStopMap</code> - for returning the results</dd><dd><code>routeId</code> - for logging</dd><dd><code>allowableDifferenceFromMeanSecs</code> - Specifies how consistent arrival/departure times from Db must
            be in order to be used.</dd><dd><code>allowableDifferenceFromOriginalTimeSecs</code> - Specifies how consistent arrival/departure times from Db must
            be in order to be used.</dd><dd><code>desiredFractionEarly</code> - Specifies the desired number of the arrival times that should
            be early</dd><dd><code>arrivalsOrDepartures</code> - specifies whether should handle as arrivals or departures</dd></dl>
</li>
</ul>
<a name="processScheduleAdherence(java.util.Map, java.util.Map, java.util.Map, int, int)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>processScheduleAdherence</h4>
<pre>public static&nbsp;void&nbsp;processScheduleAdherence(java.util.Map&lt;<a href="../../../org/transitime/statistics/ScheduleDataProcessor.TripStopKey.html" title="class in org.transitime.statistics">ScheduleDataProcessor.TripStopKey</a>,<a href="../../../org/transitime/gtfs/gtfsStructs/GtfsStopTime.html" title="class in org.transitime.gtfs.gtfsStructs">GtfsStopTime</a>&gt;&nbsp;gtfsStopTimes,
                            java.util.Map&lt;<a href="../../../org/transitime/statistics/ScheduleDataProcessor.TripStopKey.html" title="class in org.transitime.statistics">ScheduleDataProcessor.TripStopKey</a>,<a href="../../../org/transitime/statistics/ScheduleStatistics.Stats.html" title="class in org.transitime.statistics">ScheduleStatistics.Stats</a>&gt;&nbsp;arrivalStatsResultsByTripStopMap,
                            java.util.Map&lt;<a href="../../../org/transitime/statistics/ScheduleDataProcessor.TripStopKey.html" title="class in org.transitime.statistics">ScheduleDataProcessor.TripStopKey</a>,<a href="../../../org/transitime/statistics/ScheduleStatistics.Stats.html" title="class in org.transitime.statistics">ScheduleStatistics.Stats</a>&gt;&nbsp;departureStatsResultsByTripStopMap,
                            int&nbsp;allowableEarlySecs,
                            int&nbsp;allowableLateSecs)</pre>
<div class="block">Determines and logs schedule adherence results both using the original
 schedule and using the new improved schedule.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>gtfsStopTimes</code> - The original GtfsStopTimes read from stop_times.txt.</dd><dd><code>arrivalStatsResultsByTripStopMap</code> - All the arrival time results. Keyed on trip/stop.</dd><dd><code>departureStatsResultsByTripStopMap</code> - All the departure time results. Keyed on trip/stop.</dd><dd><code>allowableEarlySecs</code> - For schedule determining adherence</dd><dd><code>allowableLateSecs</code> - For schedule determining adherence</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ScheduleStatistics.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../org/transitime/statistics/ScheduleDataProcessor.TripStopKey.html" title="class in org.transitime.statistics"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../org/transitime/statistics/ScheduleStatistics.Stats.html" title="class in org.transitime.statistics"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/transitime/statistics/ScheduleStatistics.html" target="_top">Frames</a></li>
<li><a href="ScheduleStatistics.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
